{ 
  "description": "Calculate the highest ever score per student for a given assessment.",
  "description" : "Given an assessment id, lookup all student assessment associations (SAA) and emit the student id, tenantId, and SAA entity.",
  "map_class" : "org.slc.sli.aggregation.mapreduce.map.IDMapper",
  "input_key_type" : "org.slc.sli.aggregation.mapreduce.map.key.IdFieldEmittableKey",
  "input_value_type" : "com.mongodb.hadoop.io.BSONWritable",
  "input_collection" : "sli.studentAssessmentAssociation",
  "input_key_field" : "body.studentId",
  "read_from_secondaries" : true,
  "by_value" : false,
  "query" : "{ \"body.assessmentId\" : \"@ID@\", \"body.scoreResults.assessmentReportingMethod\":\"Scale score\" }",
  "fields" : "{ \"metaData.tenantId\" : 1, \"body.studentId\" : 1, \"body.scoreResults\" : 1 }",
  "output_key_type" : "org.slc.sli.aggregation.mapreduce.map.key.IdFieldEmittableKey",
  "output_value_type" : "org.apache.hadoop.io.BSONWritable"  
}
